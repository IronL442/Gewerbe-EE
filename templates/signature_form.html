<div class="mb-3">
    <label class="form-label">Signature</label>
    <canvas id="signature-pad" class="signature-pad"></canvas>
    <input type="hidden" name="signature_data" id="signature-data">
</div>

<script>
    const canvas = document.getElementById("signature-pad");
    const ctx = canvas.getContext("2d");
    let drawing = false;

    canvas.addEventListener("mousedown", () => (drawing = true));
    canvas.addEventListener("mouseup", () => (drawing = false));
    canvas.addEventListener("mousemove", draw);

    canvas.addEventListener("touchstart", () => (drawing = true));
    canvas.addEventListener("touchend", () => (drawing = false));
    canvas.addEventListener("touchmove", draw);

    function draw(event) {
        if (!drawing) return;
        ctx.lineWidth = 2;
        ctx.lineCap = "round";
        ctx.strokeStyle = "#000";
        ctx.lineTo(event.clientX - canvas.offsetLeft, event.clientY - canvas.offsetTop);
        ctx.stroke();
        ctx.beginPath();
        ctx.moveTo(event.clientX - canvas.offsetLeft, event.clientY - canvas.offsetTop);
    }

    function clearSignature() {
        ctx.clearRect(0, 0, canvas.width, canvas.height);
    }

    function saveSignature() {
        document.getElementById("signature-data").value = canvas.toDataURL();
    }

    // Automatically save the signature when the form is submitted
    document.querySelector("form").addEventListener("submit", function () {
        saveSignature();
    });
</script>